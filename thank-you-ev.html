<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-T84QRD6J');</script>
  <!-- End Google Tag Manager -->

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Thanks ‚Äî EV Charger Quote | A & J Electricians</title>
  <meta name="description" content="Thanks for your EV charger enquiry. See your tailored next steps and, where eligible, instant standard install pricing.">
  <meta name="robots" content="noindex,follow">

  <!-- CSP (aligned with your EICR pages) -->
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  img-src 'self' data: https://ajelectricians.co.uk https://www.googletagmanager.com https://www.google.com https://www.google.co.uk https://googleads.g.doubleclick.net https://stats.g.doubleclick.net https://www.googleadservices.com https://*.elfsight.com https://*.elfsightcdn.com https://lh3.googleusercontent.com https://maps.gstatic.com;
  script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com https://www.gstatic.com https://googleads.g.doubleclick.net https://www.googleadservices.com https://ssl.google-analytics.com https://static.elfsight.com https://*.elfsightcdn.com;
  connect-src 'self' https://www.googletagmanager.com https://www.google.com https://www.google.co.uk https://www.google.com/pagead/ https://www.google-analytics.com https://region1.google-analytics.com https://analytics.google.com https://www.googleadservices.com https://googleads.g.doubleclick.net https://www.google.com/ccm/collect https://formspree.io https://*.elfsight.com https://*.elfsightcdn.com;
  frame-src https://www.googletagmanager.com https://www.google.com https://www.google.co.uk https://td.doubleclick.net https://googleads.g.doubleclick.net https://*.elfsight.com https://*.elfsightcdn.com;
  style-src 'self' 'unsafe-inline' https://*.elfsight.com https://*.elfsightcdn.com;
  font-src 'self' data: https://*.elfsight.com https://*.elfsightcdn.com;
  form-action 'self' https://formspree.io;
  " />

  <style>
    :root { --blue:#0b2e57; --muted:#586174; --border:#e6ebf2; --ok:#1a7f37; --warn:#8a5a00; --accent:#c8d100; }
    * { box-sizing:border-box; }
    body { margin:0; font-family:Arial, sans-serif; color:#111; background:#fff; }
    header { display:flex; align-items:center; justify-content:center; padding:12px 16px; border-bottom:1px solid #eee; }
    header .brand { display:flex; align-items:center; gap:12px; }
    header img { height:50px; width:auto; }
    header .phone { margin-left:auto; font-weight:800; }
    header .phone a { color:#0b2e57; text-decoration:none; border:2px solid #0b2e57; padding:6px 10px; border-radius:10px; }

    .wrap { max-width:1000px; margin:28px auto; padding:0 18px; }
    .hero { background:#fff; border:1px solid #eee; border-radius:14px; padding:24px; box-shadow:0 6px 20px rgba(0,0,0,.06); }
    .hero h1 { margin:0 0 6px; color:var(--blue); font-size:clamp(1.35rem,3.2vw,1.9rem); }
    .muted { color:var(--muted); }
    .tag { display:inline-block; background:#f5f7ff; border:1px solid #e2e8ff; color:#223; padding:4px 10px; border-radius:999px; font-size:.85rem; margin-right:6px; }
    .badge-ok { background:#e8f6ee; border:1px solid #bfe7cb; color:#0b3f22; }
    .badge-warn { background:#fff7e6; border:1px solid #ffe1a6; color:#5c3d00; }

    .content { display:grid; grid-template-columns:1.2fr 1fr; gap:18px; margin-top:18px; }
    @media (max-width:960px){ .content{ grid-template-columns:1fr; } }

    .card { background:#fff; border:1px solid var(--border); border-radius:14px; padding:18px; }
    .card h2 { margin:0 0 10px; color:#0b2e57; font-size:1.25rem; }
    .charger-card { display:grid; grid-template-columns:120px 1fr; gap:14px; align-items:center; }
    .charger-card img { width:120px; height:auto; border-radius:10px; background:#f6f8ff; padding:8px; border:1px solid #eef2fb; }
    .price { font-weight:900; font-size:1.35rem; margin:6px 0; }
    .pills { margin:6px 0; }
    .pill { display:inline-block; font-size:.78rem; background:#eef3ff; border:1px solid #d7e0ff; color:#2b4c8a; border-radius:999px; padding:4px 10px; margin-right:6px; margin-bottom:6px; }

    .cta-row { display:flex; flex-wrap:wrap; gap:10px; margin-top:12px; }
    .btn { display:inline-block; padding:12px 14px; border-radius:10px; text-decoration:none; font-weight:800; border:2px solid transparent; }
    .btn-primary { background:var(--accent); color:#111; }
    .btn-ghost { background:#fff; border-color:#0b2e57; color:#0b2e57; }
    .btn-call { background:#0b2e57; color:#fff; }

    .list { margin:8px 0 0 18px; }
    .list li { margin:6px 0; }

    .tiny { font-size:.92rem; color:var(--muted); margin-top:10px; }
    .smallprint { font-size:.9rem; color:#334; border-top:1px dashed #dfe3ef; padding-top:10px; margin-top:10px; }

    .aside { background:#f9fafc; border:1px solid #e8edf7; border-radius:12px; padding:14px; }
    .kicker { font-weight:700; margin-bottom:6px; }

    footer { text-align:center; padding:22px 0 38px; color:#555; }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T84QRD6J"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

  <header>
    <div class="brand">
      <img src="Logo1.png" alt="A & J Electricians">
    </div>
    <div class="phone">
      <a href="tel:07837184672">üìû 07837184672</a>
    </div>
  </header>

  <div class="wrap">
    <section class="hero">
      <h1 id="headline">Thanks ‚Äî we‚Äôve got your EV charger details</h1>
      <p class="muted" id="sub">One of our NAPIT-registered electricians will be in touch shortly.</p>
      <div id="statusRow" style="margin-top:8px;"></div>
    </section>

    <section class="content" id="dynamicContent" style="display:none;">
      <!-- LEFT: Charger details / price or survey needed -->
      <div class="card" id="leftCard">
        <h2 id="leftTitle">Your chosen charger</h2>
        <div class="charger-card">
          <img id="chargerImg" src="" alt="">
          <div>
            <div id="chargerName" style="font-weight:800; font-size:1.05rem;"></div>
            <div class="pills" id="chargerPills"></div>
            <div class="price" id="priceLine"></div>
            <ul class="list" id="bulletList"></ul>
            <div class="cta-row" id="ctaRow">
              <a href="tel:07837184672" class="btn btn-call" id="callNowBtn">üìû Call Now to Book Your Install</a>
              <a href="#" class="btn btn-primary" id="callbackBtn">Book a Callback</a>
              <a href="#" class="btn btn-ghost" id="whatsBtn">WhatsApp Us</a>
            </div>
            <div class="smallprint" id="smallprint">
              Standard install includes up to <strong>10 m</strong> of surface-clipped cable, one wall drill-through, load management (CT clamp), tidy work, testing & certification. Extras are <strong>¬£15 per additional metre</strong>. Consumer-unit or bonding upgrades are priced after a quick survey. Typical install time: around <strong>2 hours</strong>.
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Next steps & trust -->
      <aside class="card">
        <h2>What happens next</h2>
        <ol class="list" style="margin-left:18px">
          <li>We review your details (and photos if sent).</li>
          <li>We confirm your price & earliest install slot.</li>
          <li>Install day: ~2 hours. We set up the app & show you off-peak scheduling.</li>
        </ol>
        <div class="aside" style="margin-top:10px;">
          <div class="kicker">Prefer to speak now?</div>
          <a class="btn btn-call" href="tel:07837184672">üìû 07837184672</a>
        </div>

        <div class="aside" style="margin-top:10px;">
          <div class="kicker">Trusted local electricians</div>
          <p style="margin:6px 0;">Serving Bradford, Leeds, Halifax, Keighley & Huddersfield since 2007. NAPIT certified, fully insured. Check our latest reviews on Google.</p>
        </div>
      </aside>
    </section>

    <!-- Fallback (if no data) -->
    <section class="card" id="fallback" style="display:none; margin-top:18px;">
      <h2>Thanks ‚Äî we‚Äôll be in touch</h2>
      <p class="muted">We couldn‚Äôt read your selections, but that‚Äôs okay. We‚Äôll review your enquiry and contact you shortly.</p>
      <div class="cta-row">
        <a href="tel:07837184672" class="btn btn-call">üìû Call Now to Book</a>
        <a href="/" class="btn btn-ghost">‚Üê Back to home</a>
      </div>
    </section>
  </div>

  <footer>
    <div>NAPIT Certified ‚Ä¢ Fully Insured ‚Ä¢ Est. 2007 ‚Ä¢ A &amp; J Electricians</div>
  </footer>

  <script>
    // --- Charger catalogue (images must exist on your site as named below)
    const CHARGERS = {
      "Sync EV (untethered)": {
        img: "Syncunthered.jpeg",
        alt: "Sync EV charger (untethered)",
        price: 800,
        pills: ["7.4 kW","Compact","App control"],
        bullets: [
          "Super-compact body with a clean untethered look",
          "Smart app with scheduling; solar-aware mode",
          "Dynamic load management via CT clamp"
        ]
      },
      "Rolec EVO Intelligent Smart": {
        img: "RolecEVOIntelligentSmart.png",
        alt: "Rolec EVO Intelligent Smart EV charger",
        price: 850,
        pills: ["7.4 kW","Solar-ready","Wi-Fi/App"],
        bullets: [
          "Established UK brand with robust aftercare",
          "Smart schedules and surplus-solar modes (Eco/Eco+)",
          "Load balancing & PME fault protection"
        ]
      },
      "Ohme ePod (socket)": {
        img: "OhmeePodtethered.webp",
        alt: "Ohme ePod EV charger",
        price: 899,
        pills: ["7.4 kW","Tariff-aware","Compact"],
        bullets: [
          "Great with Octopus off-peak tariffs; cost-based smart charging",
          "Untethered Type 2 socket keeps the look tidy",
          "App control with charge targets and schedules"
        ]
      },
      "Ohme Home Pro (tethered)": {
        img: "OhmeHomeProSmart.webp",
        alt: "Ohme Home Pro EV charger",
        price: 950,
        pills: ["7.4 kW","Tariff-aware","Screen+App"],
        bullets: [
          "Excellent off-peak scheduling to cut costs",
          "Tethered cable and front display for quick checks",
          "Load management via CT clamp"
        ]
      },
      "myenergi Zappi (untethered)": {
        img: "myenergi-zappi-250x250.png",
        alt: "myenergi Zappi (untethered) EV charger",
        price: 1050,
        pills: ["7.4 kW","Solar-ready","Socket"],
        bullets: [
          "Eco/Eco+ modes divert surplus PV to the car",
          "Neat untethered look; great if you plan solar",
          "myenergi app & energy visualisation"
        ]
      },
      "myenergi Zappi (tethered)": {
        img: "zappiglo.jpg",
        alt: "myenergi Zappi (tethered) EV charger",
        price: 1100,
        pills: ["7.4 kW","Solar-ready","Eco/Eco+"],
        bullets: [
          "Always-ready tethered cable with PV-aware charging",
          "Ideal with existing solar and home batteries",
          "myenergi app & energy visualisation"
        ]
      },
      "Hypervolt Home 3.0 Pro": {
        img: "HypervoltHome3Pro.png",
        alt: "Hypervolt Home 3.0 Pro EV charger",
        price: 1100,
        pills: ["7.4 kW","Wi-Fi/App","Premium"],
        bullets: [
          "Premium finish with OTA updates and strong app",
          "Scheduling & integrations; good with PV/battery setups",
          "Dynamic load management"
        ]
      }
    };

    // --- Read URL params
    const params = new URLSearchParams(location.search);
    const chosen = params.get('charger') ? decodeURIComponent(params.get('charger')) : "";

    // --- Try to read full answers from sessionStorage set on the quote page (optional enhancement)
    // Expected schema (string values): charger_preference, run, parking_spot, meter_location, name, postcode
    let evQuote = null;
    try {
      evQuote = JSON.parse(sessionStorage.getItem('evQuote') || "null");
    } catch(e){ evQuote = null; }

    // Compose data model
    const data = {
      charger: chosen || (evQuote && evQuote.charger_preference) || "",
      run: (evQuote && evQuote.run) || "",                       // "0‚Äì10 metres" | "10‚Äì20 metres" | "More than 20 metres"
      parking_spot: (evQuote && evQuote.parking_spot) || "",     // "Front of house / driveway" | "Side of house" | "Garage" | "Somewhere else"
      meter_location: (evQuote && evQuote.meter_location) || "", // "On an outside wall" | "Inside, on an external wall" | "Inside, on an internal wall"
      name: (evQuote && evQuote.name) || "",
      postcode: (evQuote && evQuote.postcode) || ""
    };

    // Personalise hero
    if (data.name) {
      document.getElementById('headline').textContent = `Thanks, ${data.name} ‚Äî we‚Äôve got your EV charger details`;
    }

    // Decide standard vs non-standard (only if we have enough info)
    function isStandard(d){
      if (!d.run || !d.parking_spot || !d.meter_location) return null; // unknown
      const runOK = d.run === "0‚Äì10 metres";
      const parkingOK = d.parking_spot !== "Somewhere else";
      const meterOK = (d.meter_location === "On an outside wall") || (d.meter_location === "Inside, on an external wall");
      return (runOK && parkingOK && meterOK);
    }

    function nonStandardReasons(d){
      const reasons = [];
      if (d.run && d.run !== "0‚Äì10 metres") reasons.push("run is over 10 m");
      if (d.parking_spot === "Somewhere else") reasons.push("parking location needs checking");
      if (d.meter_location === "Inside, on an internal wall") reasons.push("meter is on an internal wall");
      return reasons;
    }

    // Populate status badge
    (function renderStatus(){
      const row = document.getElementById('statusRow');
      row.innerHTML = '';
      const std = isStandard(data);
      if (std === true) {
        const b = document.createElement('span');
        b.className = 'tag badge-ok';
        b.textContent = 'Standard install detected';
        row.appendChild(b);
      } else if (std === false) {
        const b = document.createElement('span');
        b.className = 'tag badge-warn';
        const reasons = nonStandardReasons(data);
        b.textContent = reasons.length ? ('Needs quick survey ‚Äî ' + reasons.join(', ')) : 'Needs quick survey';
        row.appendChild(b);
      } else {
        // unknown
        const b = document.createElement('span');
        b.className = 'tag';
        b.textContent = 'We‚Äôll confirm details shortly';
        row.appendChild(b);
      }
    })();

    // Render main content
    (function renderPage(){
      const dynamic = document.getElementById('dynamicContent');
      const fallback = document.getElementById('fallback');

      // If we have *no* charger info at all, show fallback
      if (!data.charger || !CHARGERS[data.charger]) {
        dynamic.style.display = 'none';
        fallback.style.display = 'block';
        // push minimal event
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'thankyou_ev_view', state:'fallback'});
        return;
      }

      // Fill charger card
      const spec = CHARGERS[data.charger];
      document.getElementById('chargerImg').src = spec.img;
      document.getElementById('chargerImg').alt = spec.alt;
      document.getElementById('chargerName').textContent = data.charger;

      const pills = document.getElementById('chargerPills');
      pills.innerHTML = '';
      spec.pills.forEach(p=>{
        const el = document.createElement('span');
        el.className = 'pill';
        el.textContent = p;
        pills.appendChild(el);
      });

      const bullets = document.getElementById('bulletList');
      bullets.innerHTML = '';
      spec.bullets.forEach(b=>{
        const li = document.createElement('li'); li.textContent = b; bullets.appendChild(li);
      });

      // Price / non-standard copy
      const std = isStandard(data);
      const priceLine = document.getElementById('priceLine');
      if (std === true) {
        priceLine.textContent = `¬£${spec.price.toLocaleString()} ‚Äî standard install`;
      } else if (std === false) {
        const rsn = nonStandardReasons(data);
        priceLine.textContent = rsn.length
          ? `From ¬£${spec.price.toLocaleString()} ‚Äî we‚Äôll confirm after a quick photo survey (${rsn.join(', ')})`
          : `From ¬£${spec.price.toLocaleString()} ‚Äî we‚Äôll confirm after a quick photo survey`;
      } else {
        // unknown
        priceLine.textContent = `From ¬£${spec.price.toLocaleString()} ‚Äî we‚Äôll confirm the exact price shortly`;
      }

      // WhatsApp + Callback links (prefill message)
      const msg = encodeURIComponent(
        `Hi A & J, I've just completed the EV quote form.\n` +
        `Charger: ${data.charger}\n` +
        (data.postcode ? `Postcode: ${data.postcode}\n` : ``) +
        (data.run ? `Run: ${data.run}\n` : ``) +
        (data.parking_spot ? `Parking: ${data.parking_spot}\n` : ``) +
        (data.meter_location ? `Meter: ${data.meter_location}\n` : ``) +
        `Can you call me to book?`
      );
      const wa = document.getElementById('whatsBtn');
      wa.href = `https://wa.me/447837184672?text=${msg}`;
      wa.addEventListener('click', ()=> {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'ev_tap_whatsapp', charger:data.charger});
      });

      const cb = document.getElementById('callbackBtn');
      cb.href = `mailto:ajelectriciansbradford@gmail.com?subject=Callback%20request%20for%20${encodeURIComponent(data.charger)}&body=${msg}`;
      cb.addEventListener('click', ()=> {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'ev_tap_book_callback', charger:data.charger});
      });

      const call = document.getElementById('callNowBtn');
      call.addEventListener('click', ()=> {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'ev_tap_call_now', charger:data.charger});
      });

      // Show content
      dynamic.style.display = 'grid';
      fallback.style.display = 'none';

      // Push view event
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        event:'thankyou_ev_view',
        charger:data.charger,
        state: (std === true ? 'standard' : (std === false ? 'non_standard' : 'unknown'))
      });
    })();

    // Fire your existing GTM success event (mirrors EICR thank-you behavior)
    (function pushSuccessEvent(){
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        event: 'form_submit_success',
        form_name: 'ev-quote'
      });
    })();
  </script>
</body>
</html>
